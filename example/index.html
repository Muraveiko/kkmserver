<html>
<head>
    <meta charset="utf-8">
    <script src="../src/kkmserver.js"></script>
    <script>

        /**
         * Функция вызываемая после обработки команды - обработка возвращаемых данных
         * @param {{Status,Error,URL,Command,IdCommand,NumDevice}} Rezult - ответ ККM
         */
        function ExecuteSuccess(Rezult) {
            var Responce = "";

            if (Rezult.Status === 0) {
                Responce = Responce + "Статус: " + "Ok" + "\r\n";
            } else if (Rezult.Status === 1) {
                Responce = Responce + "Статус: " + "Выполняется" + "\r\n";
            } else if (Rezult.Status === 2) {
                Responce = Responce + "Статус: " + "Ошибка!" + "\r\n";
            } else if (Rezult.Status === 3) {
                Responce = Responce + "Статус: " + "Данные не найдены!" + "\r\n";
            }


            // Текст ошибки
            if (Rezult.Error !== undefined && Rezult.Error !== "") {
                Responce = Responce + "Ошибка: " + Rezult.Error + "\r\n";
            }

            if (Rezult !== undefined) {
                var JSon = JSON.stringify(Rezult, '', 4);
                Responce = Responce + "JSON ответа: \r\n" + JSon + "\r\n";
            }

            document.getElementById('Responce').textContent = Responce;
        }

        // Инитим
        // минимальный вызов  KkmServer.connect('Admin','').setHookAjaxSuccess(ExecuteSuccess);
        KkmServer.connect('Admin', '').setHookAjaxSuccess(ExecuteSuccess).setCashierName('Иванова О.П.').setInnKkm('7701237658').setNumDevice(0);

        // примеры
        function SetDevice() {
            KkmServer.setNumDevice(document.getElementById('SetDevice').value);
        }

        function Fiscal_order() {
            var check = KkmServer.RegisterCheck(0);
            KkmServer.AddRegisterString(check, 'Шило', 1, 10.01, 10.01);
            KkmServer.AddRegisterString(check, 'Мыло', 1, 2, 2);
            check.Cash = 12.01;
            check.CashLessType1 = 0;
            KkmServer.Execute(check);
        }


    </script>
</head>
<body>
<label>Номер устройства:
    <select id="SetDevice" onchange="SetDevice()">
        <option value="0">Первое активное: 0</option>
        <option value="1">Устройство №: 1</option>
        <option value="2">Устройство №: 2</option>
        <option value="3">Устройство №: 3</option>
        <option value="4">Устройство №: 4</option>
        <option value="5">Устройство №: 5</option>
        <option value="6">Устройство №: 6</option>
        <option value="7">Устройство №: 7</option>
        <option value="8">Устройство №: 8</option>
    </select></label>
<p>
    <button onclick="Fiscal_order()" style="width: 300px;">Печать заранее заготовленного чека</button>
</p>

<table>
    <tr>
        <td style="width:50%">
            <h2>Команда как аргумент</h2>
            <p>
                <button onclick="KkmServer.Execute(KkmServer.commandOpenShift())" style="width: 300px;">Открытие смены</button>
            </p>
            <p>
                <button onclick="KkmServer.Execute(KkmServer.commandXReport())" style="width: 300px;">Печать Х отчета</button>
            </p>
            <p>
                <button onclick="KkmServer.Execute(KkmServer.commandZReport())" style="width: 300px;">Печать Z отчета</button>
            </p>
            <p>
                <button onclick="KkmServer.Execute(KkmServer.commandOfdReport())" style="width: 300px;">Печать состояния
                    расчетов и связи с
                    ОФД
                </button>
            </p>
            <hr>
            <p>
                <label>Сумма : <input id="Amount" type="text" value="0.01"/></label>
            </p>
            <p>
                <button onclick="KkmServer.Execute(KkmServer.commandPaymentCash(document.getElementById('Amount').value))"
                        style="width: 300px;">Инкассация денег из кассы
                </button>
            </p>
            <p>
                <button onclick="KkmServer.Execute(KkmServer.commandDepositingCash(document.getElementById('Amount').value))"
                        style="width: 300px;">Внесение денег в кассу
                </button>
            </p>
            <p>
                <button onclick="KkmServer.Execute(KkmServer.commandOpenCashDrawer())" style="width: 300px;">Открытие денежного
                    ящика
                </button>
            </p>
            <hr>
            <p>
                <button onclick="KkmServer.Execute(KkmServer.commandGetDataKKT())" style="width: 300px;">Получить текущее
                    состояние ККТ.
                </button>
            </p>
            <hr>
            <p>
                <button onclick="KkmServer.Execute(KkmServer.commandList())" style="width: 300px;">Получение списка ККМ
                </button>
            </p>
        </td>
        <td>
            <h2>Короткий вызов</h2>
            <p>
                <button onclick="KkmServer.OpenShift().Execute()" style="width: 300px;">Открытие смены</button>
            </p>
            <p>
                <button onclick="KkmServer.XReport().Execute()" style="width: 300px;">Печать Х отчета</button>
            </p>
            <p>
                <button onclick="KkmServer.printZReport()" style="width: 300px;">Печать Z отчета</button>
            </p>
            <p>
                <button onclick="KkmServer.OfdReport().Execute()" style="width: 300px;">Печать состояния
                    расчетов и связи с
                    ОФД
                </button>
            </p>
            <hr>
            <p>
                <label>Сумма : <input id="Amount2" type="text" value="0.01"/></label>
            </p>
            <p>
                <button onclick="KkmServer.PaymentCash(document.getElementById('Amount').value).Execute()"
                        style="width: 300px;">Инкассация денег из кассы
                </button>
            </p>
            <p>
                <button onclick="KkmServer.DepositingCash(document.getElementById('Amount').value).Execute()"
                        style="width: 300px;">Внесение денег в кассу
                </button>
            </p>
            <p>
                <button onclick="KkmServer.OpenCashDrawer().Execute()" style="width: 300px;">Открытие денежного
                    ящика
                </button>
            </p>
            <hr>
            <p>
                <button onclick="KkmServer.GetDataKKT().Execute()" style="width: 300px;">Получить текущее
                    состояние ККТ.
                </button>
            </p>
            <hr>
            <p>
                <button onclick="KkmServer.List().Execute()" style="width: 300px;">Получение списка ККМ
                </button>
            </p>
        </td>
    </tr>
</table>
<p>Ответ сервера:</p>
<p id="Responce" style="white-space:pre;"></p>


</body>
</html>