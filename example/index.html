<html>
<head>
    <meta charset="utf-8">
    <script
            src="https://code.jquery.com/jquery-1.12.4.min.js"
            integrity="sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ="
            crossorigin="anonymous"></script>
    <script src="../src/kkmserver.js"></script>
    <script>

        // Функция вызываемая после обработки команды - обработка возвращаемых данных
        function ExecuteSuccess(Rezult) {
            var Responce = "";

            if (Rezult.Status === 0) {
                Responce = Responce + "Статус: " + "Ok" + "\r\n";
            } else if (Rezult.Status === 1) {
                Responce = Responce + "Статус: " + "Выполняется" + "\r\n";
            } else if (Rezult.Status === 2) {
                Responce = Responce + "Статус: " + "Ошибка!" + "\r\n";
            } else if (Rezult.Status === 3) {
                Responce = Responce + "Статус: " + "Данные не найдены!" + "\r\n";
            }


            // Текст ошибки
            if (Rezult.Error !== undefined && Rezult.Error !== "") {
                Responce = Responce + "Ошибка: " + Rezult.Error + "\r\n";
            }

            if (Rezult !== undefined) {
                var JSon = JSON.stringify(Rezult, "", 4);
                Responce = Responce + "JSON ответа: \r\n" + JSon + "\r\n";
            }

            document.getElementById('Responce').textContent = Responce;
            //$(".Responce").text(Responce);
        }

        // Инитим
        // минимальный вызов  KkmServer.Connect('Admin','').HookAjaxSuccess(ExecuteSuccess);
        KkmServer.Connect('Admin','','http://localhost:5893/').HookAjaxSussecc(ExecuteSuccess).SetCashierName('Иванова О.П.').SetNumDevice(0);

        // примеры
        function SetDevice() {
            KkmServer.SetNumDevice(document.getElementById('SetDevice').value);
        }

        function Fiscal_order(){
            var check = KkmServer.RegisterCheck(0);
            KkmServer.AddRegisterString(check,'Шило',1,10.01,10.01);
            KkmServer.AddRegisterString(check,'Мыло',1,2,2);
            check.Cash=12.01;
            check.CashLessType1=0;
            KkmServer.Execute(check);
        }

    </script>
</head>
<body>
Номер устройства:
<select id="SetDevice" onchange="SetDevice()">
    <option value="0">Первое активное: 0</option>
    <option value="1">Устройство №: 1</option>
    <option value="2">Устройство №: 2</option>
    <option value="3">Устройство №: 3</option>
    <option value="4">Устройство №: 4</option>
    <option value="5">Устройство №: 5</option>
    <option value="6">Устройство №: 6</option>
    <option value="7">Устройство №: 7</option>
    <option value="8">Устройство №: 8</option>
</select>
<p>
    <button onclick="Fiscal_order()" style="width: 300px;">Печать заранее заготовленного чека</button>
</p>

<p>--------------------------------------------------------</p>
<p>
    <button onclick="KkmServer.Execute(KkmServer.OpenShift())" style="width: 300px;">Открытие смены</button>
</p>
<p>
    <button onclick="KkmServer.Execute(KkmServer.XReport())" style="width: 300px;">Печать Х отчета</button>
</p>
<p>
    <button onclick="KkmServer.Execute(KkmServer.ZReport())" style="width: 300px;">Печать Z отчета</button>
</p>
<p>
    <button onclick="KkmServer.Execute(KkmServer.OfdReport())" style="width: 300px;">Печать состояния расчетов и связи с
        ОФД
    </button>
</p>
<hr>
<p>
     Сумма : <input id="Amount" type="text" value="0.01" />
</p>
<p>
    <button onclick="KkmServer.Execute(KkmServer.PaymentCash(document.getElementById('Amount').value))" style="width: 300px;">Инкассация денег из кассы
    </button>
</p>
<p>
    <button onclick="KkmServer.Execute(KkmServer.DepositingCash(document.getElementById('Amount').value))" style="width: 300px;">Внесение денег в кассу
    </button>
</p>
<p>
    <button onclick="KkmServer.Execute(KkmServer.OpenCashDrawer())" style="width: 300px;">Открытие денежного ящика
    </button>
</p>
<hr>
<p>
    <button onclick="KkmServer.Execute(KkmServer.GetDataKKT())" style="width: 300px;">Получить текущее состояние ККТ.
    </button>
</p>
<hr>
<p>
    <button onclick="KkmServer.Execute(KkmServer.List())" style="width: 300px;">Получение списка ККМ</button>
</p>
<p>Ответ сервера:</p>
<p id="Responce" style="white-space:pre;"></p>


</body>
</html>