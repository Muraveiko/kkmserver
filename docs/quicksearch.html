<html>
<head>
</head>
<body style="background: transparent;">
    <script src="scripts/docstrap.lib.js"></script>
    <script src="scripts/lunr.min.js"></script>
    <script src="scripts/fulltext-search.js"></script>

    <script type="text/x-docstrap-searchdb">
    {"classes.list.html":{"id":"classes.list.html","title":"Classes","body":" KkmServer API Classes KkmCheckKkmCheckPropertyKkmCommandKkmCommandCheckKkmCommandListKkmCommandWithAmountKkmCommandWithCashierKkmResponseKkmResponseErrorKkmServer Classes Classes KkmCheck KkmCheckProperty KkmCommand KkmCommandCheck KkmCommandList KkmCommandWithAmount KkmCommandWithCashier KkmResponse KkmResponseError KkmServer Класс для взаимодействия с API × Search results Close "},"index.html":{"id":"index.html","title":"Index","body":" KkmServer API Classes KkmCheckKkmCheckPropertyKkmCommandKkmCommandCheckKkmCommandListKkmCommandWithAmountKkmCommandWithCashierKkmResponseKkmResponseErrorKkmServer KkmServer.jsJs-библиотека для взаимодействия со специальным сервером(KkmServer), посредствомAjax запросов. Дополнительные библиотеки не требуются. Кратко о KkmServer Программа предназначена для печати и регистрации фискальных/не фискальных чеков на Контрольно-кассовой технике оборудованной фискальным накопителем (далее ККТ). Программа является маленьким HTTP web-сервером и имеет встроенные драйвера ККТ (кроме драйверов Usb-Com). Позволяет печатать/регистрировать чеки с мобильных устройств / планшетов или с настольного ПК из 1с одновременно. Позволяет печатать/регистрировать чеки на KKM подключенных к другим ПК. Есть возможность печати этикеток с штрих-кодами на принтерах этикеток. Так-же возможно использовать ККТ в качестве принтера этикеток. Технология использования - HTTP(Ajax/REST) запрос, данные передаются через JSON; Страница программы Пример использованияСмотрите в ./examples/ HistoryАльфа версии 0.2.0 - Извините еще один полный рефакторинг (предыдущий вариант плохо документировался и не получалось сделать автокомплит) 0.1.0 - Переработан полностью набор методов. Добавлена документация. 0.0.2 - Первая публичная версия Index kkmserver.js Js-библиотека для взаимодействия со специальным сервером, посредством Ajax запросов. Дополнительные библиотеки не требуются. Version: 0.2.0 Author: Oleg Muraveyko See: Source code on Github https://github.com/Muraveiko/kkmserver Server API part by Dmitriy Garbuz https://kkmserver.ru/KkmServer × Search results Close "},"KkmCheck.html":{"id":"KkmCheck.html","title":"Class: KkmCheck","body":" KkmServer API Classes KkmCheckKkmCheckPropertyKkmCommandKkmCommandCheckKkmCommandListKkmCommandWithAmountKkmCommandWithCashierKkmResponseKkmResponseErrorKkmServer Class: KkmCheck KkmCheck new KkmCheck(kkm [, typeCheck]) Конструктор Класса Чек (для работы с фискальным документом или слип-чеком) Parameters: Name Type Argument Default Description kkm KkmServer куда посылать typeCheck number &lt;optional&gt; 0 Тип чека 0 – продажа; 10 – покупка; 1 – возврат продажи; 11 - возврат покупки; 8 - продажа только по ЕГАИС (обычный чек ККМ не печатается) 9 - возврат продажи только по ЕГАИС (обычный чек ККМ не печатается) Example // ранее у Вас должен быть определен // var kkm = new KkmServer(...); var check = new KkmCheck(kkm,0); // 0 - здесь явно указал тип продажа // дальше формируем его check.r(...).t(...).b(...).i(...) // рекомендую использовать шорткаты // или полные варианты addXxxString(), если нужно модифицировать сформированную строку var goodsWithEgais = check.addRegisterString(...); goodsWithEgais.EGAIS = { Barcode: &quot;22N0000154NUCPRZ3R8381461004001003499NKAQ0ZBUVDNV62JQAR69PEV878RO93V&quot;, Ean: &quot;3423290167937&quot;, Volume: 0.7500, }; // и в конце вызываем check.fiscal(); // или .print() Members kkm :KkmServer ккм - сервер Type: KkmServer &lt;inner&gt; data :KkmCommandCheck Данные для передачи апи Type: KkmCommandCheck Methods addBarcodeString(BarcodeType, Barcode) Добавление печати штрихкода. Parameters: Name Type Description BarcodeType string &quot;EAN13&quot;, &quot;CODE39&quot;, &quot;CODE128&quot;, &quot;QR&quot;, &quot;PDF417&quot; Barcode string Значение See: шорткат b() Returns: Type Object Example var barString = check.addBarcodeString(&quot;EAN13&quot;, &quot;1254789547853&quot;); // можно модифицировать сформированную строку barString.BarcodeType = ''; barString.Barcode = ''; addImageString(Image) Строка с печатью картинки Parameters: Name Type Description Image string Картинка в Base64. Картинка будет преобразована в 2-х цветное изображение - поэтому лучше посылать 2-х цветный bmp See: шорткат i() Returns: Type Object Example check.addImageString('').Image = demoImage; // можно модифицировать addRegisterString(name, quantity, price, amount [, tax] [, department] [, ean13]) Фискальная строка чека Parameters: Name Type Argument Description name string Название товара quantity number Количество price number цена amount number сумма tax number &lt;optional&gt; Налогообложение department &lt;optional&gt; отдел магазина ean13 string &lt;optional&gt; штрих код Returns: Type Object addTextString(Text [, Font] [, Intensity]) Добавляем текстовую строку Parameters: Name Type Argument Description Text string текст для вывода с управляющими кодами Font number &lt;optional&gt; Шрифт 1-4 Intensity number &lt;optional&gt; Интесивность Returns: Type Object b(BarcodeType, Barcode) Шорткат к addBarcodeString. Поддерживает цепочку вызовов. Parameters: Name Type Description BarcodeType string Barcode string See: addBarcodeString Returns: Type KkmCheck fiscal() Фискализация чека Returns: Type KkmCommandCheck fiscalCard() Фискализация оплаты картой Returns: Type KkmCommandCheck Example check.setTotal(100).fiscalCard(); // эквиваленто check.setPayments(0,100).fiscal(); fiscalCash() Фискализация наличкой Returns: Type KkmCommandCheck Example // это удобнее, так как можно заготовить чек и просто повесить на две кнопки выбор способа оплаты check.r(...).r(...).r(...).setTotal(100); // заранее check.fiscalCash(); // на клик // чем еще разбираться с параметрами setPayments check.setPayments(100,0).fiscal(); // эквивалент i(Image) Шорткат к addImageString . Поддерживает цепочку вызовов. Parameters: Name Type Description Image string See: addImageString Returns: Type KkmCheck print() Печать слип-чека (произвольного документа) Returns: Type KkmCommandCheck r(Name, Quantity, Price, Amount, Tax, Department, EAN13) Шоркат к addRegisterString. Поддерживает цепочку вызовов. Parameters: Name Type Description Name string Quantity number Price number Amount number Tax number Department number EAN13 string See: addRegisterString Returns: Type KkmCheck setCheckProps(print, printInHeader, teg, value) Добаляет данные по дополнительным тегам 1005 Адрес оператора по переводу денежных средств (Строка 100) 1016 ИНН оператора по переводу денежных средств (Строка 12) 1026 Наименование оператора по переводу денежных средств (Строка 64) 1044 Операция банковского агента (Строка 24) 1045 Операция банковского субагента (Строка 24) 1073 Телефон банковского агента (Строка 19) 1074 Телефон платежного агента (Строка 19) 1075 Телефона оператора по переводу денежных средств (Строка 19) 1082 Телефон банковского субагента (Строка 19) 1083 Телефон платежного субагента (Строка 19) 1119 Телефон оператора по приему платежей (Строка 19) 1117 адрес электронной почты отправителя чека Parameters: Name Type Description print boolean печатать printInHeader boolean печатать в шапке teg number номер тега value string значение тега Returns: Type KkmCheckProperty setEmail(email) Если чек выдается электронно, то в запросе обязательно должно быть заполнено одно из полей: email или phone. Максимальная длина строки – 64 символа. Parameters: Name Type Description email string Электронная почта покупателя Returns: Type KkmCheck setInn(innKkm) Используется для предотвращения ошибочных регистраций чеков на ККТ зарегистрированных с другим ИНН (сравнивается со значением в ФН). Допустимое количество символов 10 или 12. Parameters: Name Type Description innKkm string ИНН организации Returns: Type KkmCheck setPaymentAddress(paymentAddress) Используется для предотвращения ошибочных регистраций чеков на ККТ зарегистрированных с другим адресом места расчёта (сравнивается со значением в ФН). Максимальная длина строки – 256 символов Parameters: Name Type Description paymentAddress Адрес места расчетов. To Do: попросить реализовать в апи Returns: Type KkmCheck setPayments(cash [, less1] [, less2] [, less3]) Как будет оплачен Parameters: Name Type Argument Default Description cash number Наличными less1 number &lt;optional&gt; 0 Безналичный тип 1 (по умаолчанию карта) less2 number &lt;optional&gt; 0 Безналичный тип 2 less3 number &lt;optional&gt; 0 Безналичный тип 3 See: KkmCommandCheck#CashLessType1 setPhone(phone) Если чек выдается электронно, то в запросе обязательно должно быть заполнено одно из полей: email или phone. Максимальная длина строки – 64 символа. Parameters: Name Type Description phone string Телефон покупателя. Передается без префикса «+7». Returns: Type KkmCheck setSno(sno) Система налогообложения. где sno «osn» | 0– общая СН; «usn_income» | 1– упрощенная СН(доходы); «usn_income_outcome» | 2 – упрощенная СН (доходы минус расходы); «envd» | 3 – единый налог на вмененный доход; «esn» | 4– единый сельскохозяйственный налог; «patent» | 5 – патентная СН. Parameters: Name Type Description sno string | number Система налогообложения (см. KkmCommandCheck#TaxVariant) Returns: Type KkmCheck Example check.setSno(0);// check.setSno('osn') setTaxVariant() Синоним к setSno See: KkmCheck#setSno setTotal(amount) Сумма продажи Parameters: Name Type Description amount number Returns: Type KkmCheck t(Text, Font, Intensity) Шорткат к addTextString. Поддерживает цепочку вызовов. Parameters: Name Type Description Text string Font number Intensity number See: addTextString Returns: Type KkmCheck × Search results Close "},"KkmCheckProperty.html":{"id":"KkmCheckProperty.html","title":"Class: KkmCheckProperty","body":" KkmServer API Classes KkmCheckKkmCheckPropertyKkmCommandKkmCommandCheckKkmCommandListKkmCommandWithAmountKkmCommandWithCashierKkmResponseKkmResponseErrorKkmServer Class: KkmCheckProperty KkmCheckProperty new KkmCheckProperty(print, printInHeader, teg, value) Дополнительное свойство чека Parameters: Name Type Description print boolean печатать printInHeader boolean печатать в шапке teg number номер тега value string значение тега See: KkmCheck#setCheckProps Members Print :boolean печатать Type: boolean PrintInHeader :boolean печатать в шапке Type: boolean Prop :string Значение тега Type: string Teg :number Номер тега 1005 Адрес оператора по переводу денежных средств (Строка 100) 1016 ИНН оператора по переводу денежных средств (Строка 12) 1026 Наименование оператора по переводу денежных средств (Строка 64) 1044 Операция банковского агента (Строка 24) 1045 Операция банковского субагента (Строка 24) 1073 Телефон банковского агента (Строка 19) 1074 Телефон платежного агента (Строка 19) 1075 Телефона оператора по переводу денежных средств (Строка 19) 1082 Телефон банковского субагента (Строка 19) 1083 Телефон платежного субагента (Строка 19) 1119 Телефон оператора по приему платежей (Строка 19) 1117 адрес электронной почты отправителя чека Type: number × Search results Close "},"KkmCommand.html":{"id":"KkmCommand.html","title":"Class: KkmCommand","body":" KkmServer API Classes KkmCheckKkmCheckPropertyKkmCommandKkmCommandCheckKkmCommandListKkmCommandWithAmountKkmCommandWithCashierKkmResponseKkmResponseErrorKkmServer Class: KkmCommand KkmCommand new KkmCommand(command [, numDevice]) Базовая структура запроса к серверу Parameters: Name Type Argument Description command string Имя команды numDevice number &lt;optional&gt; устройство Members Command :string Название команды, одно из зарегистрированных слов api KkmServer.ru. необходимые реализованы как методы CommandXXX KkmServer Type: string IdCommand :string Уникальный идентификатор команды Любая строока из 40 символов По этому идентификатору можно запросить результат выполнения команды. Поле не обязательно Type: string KeySubLicensing :string Kлюч суб-лицензии Type: string NumDevice :number|null Номер устройства 0-9 по умолчанию 0 - первое свободное Type: number | null × Search results Close "},"KkmCommandCheck.html":{"id":"KkmCommandCheck.html","title":"Class: KkmCommandCheck","body":" KkmServer API Classes KkmCheckKkmCheckPropertyKkmCommandKkmCommandCheckKkmCommandListKkmCommandWithAmountKkmCommandWithCashierKkmResponseKkmResponseErrorKkmServer Class: KkmCommandCheck KkmCommandCheck new KkmCommandCheck( [typeCheck]) Структура запроса к апи для работы с чеком советую использовать обертку над командой Parameters: Name Type Argument Default Description typeCheck number &lt;optional&gt; 0 Тип чека See: KkmCheck Extends KkmCommand Members AdditionalProps :Array Дополнительные произвольные реквизиты (не обязательно) пока только 1 строка Type: Array CancelOpenedCheck :boolean Аннулировать открытый чек если ранее чек небыл завершен до конца Type: boolean Cash :number Наличная оплата Type: number CashierName :string Продавец, тег ОФД 1021 Type: string CashLessType1 :number Безналичная оплата типа 1 (по умолчанию - Оплата картой) Type: number CashLessType2 :number Безналичная оплата типа 2 (по умолчанию - Оплата кредитом) Type: number CashLessType3 :number Безналичная оплата типа 3 (по умолчанию - Оплата сертификатом) Type: number CheckProps :Array.&lt;KkmCheckProperty&gt; Дополниельные реквизиты чека (не обязательно) Type: Array.&lt;KkmCheckProperty&gt; CheckStrings :Array Строки чека Type: Array ClientAddress :string Телефон или е-Майл покупателя, тег ОФД 1008 Если чек не печатается (NotPrint = true) то указывать обязательно Type: string ClientId :string Это только для тестов Type: string Command :string Команда серверу Type: string Overrides: KkmCommand#Command IdCommand :string Уникальный идентификатор команды. Любая строока из 40 символов - должна быть уникальна для каждой подаваемой команды По этому идентификатору можно запросить результат выполнения команды Type: string Overrides: KkmCommand#IdCommand InnKkm :string ИНН ККМ. Если &quot;&quot; то ККМ ищется только по NumDevice, Если NumDevice = 0 а InnKkm заполнено то ККМ ищется только по InnKkm Type: string IsFiscalCheck :boolean Это фискальный или не фискальный чек Type: boolean KeySubLicensing :string Установка ключа суб-лицензии по умолчанию: ВНИМАНИЕ: ключ суб-лицензии вы должны генерить у себя на сервере!!!! Type: string Overrides: KkmCommand#KeySubLicensing KktNumber :string Заводской номер ККМ для поиска. Если &quot;&quot; то ККМ ищется только по NumDevice Type: string KPP :string КПП организации, нужно только для ЕГАИС Type: string NotPrint :boolean Не печатать чек на бумагу Type: boolean NumberCopies :number Количество копий документа Type: number NumDevice :number|null Номер устройства. Если 0, то первое не блокированное на сервере. null - использовать значение из js-класса KkmServer Type: number | null Overrides: KkmCommand#NumDevice TaxVariant :number Система налогообложения (СНО) применяемая для чека. Если не указанно - система СНО настроенная в ККМ по умолчанию 0: Общая СНО - ОСН 1: Упрощенная СНО (Доход) 2: Упрощенная СНО(Доход минус Расход) 3: Единый налог на вмененный доход 4: Единый сельскохозяйственный налог 5: Патентная система налогообложения Комбинация разных СНО не возможна Надо указываеть если ККМ настроена на несколько систем СНО Type: number Timeout :number Время (сек) ожидания выполнения команды. Если За это время команда не выполнилась в статусе вернется результат &quot;NotRun&quot; или &quot;Run&quot; Проверить результат еще не выполненной команды можно командой &quot;GetRezult&quot; Если не указано или 0 - то значение по умолчанию 60 сек. Это поле можно указвать во всех командах Type: number TypeCheck :number Тип чека; Тип чека : 0 – продажа; 10 – покупка; 1 – возврат продажи; 11 - возврат покупки; Для новых ККМ: 2 – корректировка продажи; 12 - корректировка покупки 3 – корректировка возврата продажи; 13 - корректировка возврата покупки Type: number × Search results Close "},"KkmCommandList.html":{"id":"KkmCommandList.html","title":"Class: KkmCommandList","body":" KkmServer API Classes KkmCheckKkmCheckPropertyKkmCommandKkmCommandCheckKkmCommandListKkmCommandWithAmountKkmCommandWithCashierKkmResponseKkmResponseErrorKkmServer Class: KkmCommandList KkmCommandList new KkmCommandList() Команда Список ККТ подключенных к серверу Extends KkmCommand Members Active :boolean|null Отбор активных. Булево. Если null или не указано то активные и не активные Type: boolean | null Example command = new KkmCommandList(); command.InnKkm = '1234567890'; Command :string Название команды, одно из зарегистрированных слов api KkmServer.ru. необходимые реализованы как методы CommandXXX KkmServer Type: string Inherited From: KkmCommand#Command FN_DateEnd :string Все у которых дата окончания работы ФН меньше указанной. Дата-время. Type: string FN_IsFiscal :boolean|null Фискализированные или нет ФН; Булево. Если null или не указано то все Type: boolean | null FN_MemOverflowl :boolean|null Все у которых заканчивается память ФН; Булево. Если null или не указано то все Type: boolean | null IdCommand :string Уникальный идентификатор команды Любая строока из 40 символов По этому идентификатору можно запросить результат выполнения команды. Поле не обязательно Type: string Inherited From: KkmCommand#IdCommand InnKkm :string Отбор по ИНН. Строка. Если &quot;&quot; или не указано то первое не блокированное на сервере Type: string KeySubLicensing :string Kлюч суб-лицензии Type: string Inherited From: KkmCommand#KeySubLicensing NumDevice :number|null Номер устройства 0-9 по умолчанию 0 - первое свободное Type: number | null Inherited From: KkmCommand#NumDevice OFD_DateErrorDoc :string Все у которых дата не переданного док. в ОФД меньше указанной. Дата-время. Type: string Example command = new KkmCommandList(); command.OFD_DateErrorDoc = '2100-01-01T00:00:00'; OFD_Error :boolean|null Отбор наличию ошибок ОФВ. Булево. Если null или не указано то с ошибками и без Type: boolean | null OnOff :boolean|null Отбор выключенны-включенных Type: boolean | null Example command = new KkmCommandList(); command.Active = true; × Search results Close "},"KkmCommandWithAmount.html":{"id":"KkmCommandWithAmount.html","title":"Class: KkmCommandWithAmount","body":" KkmServer API Classes KkmCheckKkmCheckPropertyKkmCommandKkmCommandCheckKkmCommandListKkmCommandWithAmountKkmCommandWithCashierKkmResponseKkmResponseErrorKkmServer Class: KkmCommandWithAmount KkmCommandWithAmount new KkmCommandWithAmount(command, amount, cashierName, numDevice) Структура запроса к серверу c суммой операции Parameters: Name Type Description command string Имя команды amount number Сумма cashierName string ФИО Кассира numDevice number устройство Extends KkmCommandWithCashier Members Amount :number Сумма операции Type: number CashierName :string|null ФИО Кассира Type: string | null Inherited From: KkmCommandWithCashier#CashierName Command :string Название команды, одно из зарегистрированных слов api KkmServer.ru. необходимые реализованы как методы CommandXXX KkmServer Type: string Inherited From: KkmCommand#Command IdCommand :string Уникальный идентификатор команды Любая строока из 40 символов По этому идентификатору можно запросить результат выполнения команды. Поле не обязательно Type: string Inherited From: KkmCommand#IdCommand KeySubLicensing :string Kлюч суб-лицензии Type: string Inherited From: KkmCommand#KeySubLicensing NumDevice :number|null Номер устройства 0-9 по умолчанию 0 - первое свободное Type: number | null Inherited From: KkmCommand#NumDevice × Search results Close "},"KkmCommandWithCashier.html":{"id":"KkmCommandWithCashier.html","title":"Class: KkmCommandWithCashier","body":" KkmServer API Classes KkmCheckKkmCheckPropertyKkmCommandKkmCommandCheckKkmCommandListKkmCommandWithAmountKkmCommandWithCashierKkmResponseKkmResponseErrorKkmServer Class: KkmCommandWithCashier KkmCommandWithCashier new KkmCommandWithCashier(command [, cashierName] [, numDevice]) Структура запроса к серверу c ФИО кассира Parameters: Name Type Argument Description command string Имя команды cashierName string &lt;optional&gt; ФИО Кассира numDevice number &lt;optional&gt; устройство Extends KkmCommand Members CashierName :string|null ФИО Кассира Type: string | null Command :string Название команды, одно из зарегистрированных слов api KkmServer.ru. необходимые реализованы как методы CommandXXX KkmServer Type: string Inherited From: KkmCommand#Command IdCommand :string Уникальный идентификатор команды Любая строока из 40 символов По этому идентификатору можно запросить результат выполнения команды. Поле не обязательно Type: string Inherited From: KkmCommand#IdCommand KeySubLicensing :string Kлюч суб-лицензии Type: string Inherited From: KkmCommand#KeySubLicensing NumDevice :number|null Номер устройства 0-9 по умолчанию 0 - первое свободное Type: number | null Inherited From: KkmCommand#NumDevice × Search results Close "},"KkmResponse.html":{"id":"KkmResponse.html","title":"Class: KkmResponse","body":" KkmServer API Classes KkmCheckKkmCheckPropertyKkmCommandKkmCommandCheckKkmCommandListKkmCommandWithAmountKkmCommandWithCashierKkmResponseKkmResponseErrorKkmServer Class: KkmResponse KkmResponse new KkmResponse() Ответ API Properties: Name Type Argument Description Status number Статус исполнения Ok = 0,Run(Запущено на выполнение) = 1,Error = 2, NotFound(устройство не найдено) = 3,NotRun = 4 Error string Пустая строка или текст ошибки Command string Команда апи IdCommand string Уникальный идентификатор комманды, назначенный вами или присвоенный сервером. NumDevice number &lt;optional&gt; Номер устройства выполневшего команду URL string &lt;optional&gt; URL проверки чека t=20170115T154700&amp;s=0.01&amp;fn=99078900002287&amp;i=118&amp;fp=549164494&amp;n=1 где: t-дата-время, s-сумма документа, fn-номер ФН, i-номер документа, fp-фискальная подпись, n-тип документа CheckNumber number &lt;optional&gt; Номер документа SessionNumber number &lt;optional&gt; Номер смены Info object &lt;optional&gt; состояние Ккт Properties Name Type Description UrlServerOfd string URL или IP сервера ОФД PortServerOfd number IP-порт сервера ОФД NameOFD string Наименование ОФД UrlOfd string префикс URL ОФД для поиска чека InnOfd string ИНН ОФД EncryptionMode boolean Шифрование OfflineMode boolean Автономный режим AutomaticMode boolean Автоматический режим InternetMode boolean Расчеты в Интернете BSOMode boolean Бланки строгой отчетности ServiceMode boolean Применение в сфере услуг InnOrganization string ИНН организации NameOrganization string Наименование организации AddressSettle string Адрес установки ККМ TaxVariant string | number При нескольких СНО через запятую, например: &quot;0,3,5&quot; KktNumber string Заводской номер кассового аппарата FnNumber string Заводской номер фискального регистратора RegNumber string Регистрационный номер ККТ (из налоговой) OnOff boolean выключена-включенна Active boolean автивна/неактивна (на связи) Command string ???? FN_IsFiscal boolean Кассовый принтер или фискальный аппарат FN_MemOverflowl boolean Переполнен фискальный накопитель FN_DateEnd string Когда нужно менять фискальный накопитель OFD_Error string OFD_NumErrorDoc number Количество не переданных документов в ОФД OFD_DateErrorDoc string Дата первого не переданного документа в ОФД SessionState number Статус сессии 1-Закрыта, 2-Открыта, 3-Открыта, но закончилась (3 статус на старых ККМ может быть не опознан) FFDVersion string FFDVersionFN string FFDVersionKKT string PaperOver boolean Закончилась бумага BalanceCash number Остаток наличных LessType1 string Название 1 типа безналичных расчетов LessType2 string Название 2 типа безналичных расчетов LessType3 string Название 3 типа безналичных расчетов LicenseExpirationDate string number × Search results Close "},"KkmResponseError.html":{"id":"KkmResponseError.html","title":"Class: KkmResponseError","body":" KkmServer API Classes KkmCheckKkmCheckPropertyKkmCommandKkmCommandCheckKkmCommandListKkmCommandWithAmountKkmCommandWithCashierKkmResponseKkmResponseErrorKkmServer Class: KkmResponseError KkmResponseError new KkmResponseError(errMessage) Эмуляция сообщение об ошибке от API Parameters: Name Type Description errMessage Extends KkmResponse × Search results Close "},"KkmServer.html":{"id":"KkmServer.html","title":"Class: KkmServer","body":" KkmServer API Classes KkmCheckKkmCheckPropertyKkmCommandKkmCommandCheckKkmCommandListKkmCommandWithAmountKkmCommandWithCashierKkmResponseKkmResponseErrorKkmServer Class: KkmServer KkmServer new KkmServer(user, password [, urlServer]) Класс для взаимодействия с API Методы класса можно разделить на группы Внутренние: funXxx - встроенные обработчики AJAX Публичные: CommandXxx - возвращают структуру данных для передачи серверу, которую можно модифицировать doXxx - выполняют сразу нужную операцию hookXxx - установить свои обработчики для AJAX setXxx - устанавливают параметры по умолчанию для команд execute - посылает ajax запрос серверу с тонкой настройкой Через посредника: чеки - отдельный класс KkmCheck Конструктор принимает параметры подключения к серверу : Parameters: Name Type Argument Description user string Имя пользователя password string Пароль urlServer string &lt;optional&gt; Адрес сервера Example var kkm = new KkmServer('Admin', '','http://localhost:5893/').hookAjaxSuccess(ExecuteSuccess); kkm.doOpenShift(); Members lastCommand :* Последняя посланная серверу команда. Только для отладки. Type: * Methods CommandDepositingCash(amount [, cashierName] [, numDevice]) Команда Внесение денег в кассу Parameters: Name Type Argument Description amount number Сумма cashierName string &lt;optional&gt; имя кассира numDevice number &lt;optional&gt; устройство See: CommandPaymentCash Returns: Type KkmCommandWithAmount CommandGetDataKKT( [numDevice]) Команда Получение данных KKT Parameters: Name Type Argument Description numDevice number &lt;optional&gt; устройство Returns: Type KkmCommand CommandGetRezult( [idCommand] [, numDevice]) Команда Запрос результата выполнения команды Parameters: Name Type Argument Description idCommand string &lt;optional&gt; numDevice number &lt;optional&gt; устройство Returns: Type KkmCommand CommandList() Команда Список подключенных устройств Returns: Type KkmCommandList CommandOfdReport( [numDevice]) Команда Печать состояния обмена с ОФД Parameters: Name Type Argument Description numDevice number &lt;optional&gt; устройство Returns: Type KkmCommand CommandOpenCashDrawer( [numDevice]) Команда Открыть денежный ящик Parameters: Name Type Argument Description numDevice number &lt;optional&gt; устройство Returns: Type KkmCommand CommandOpenShift( [CashierName] [, numDevice]) Команда Окрыть смену Parameters: Name Type Argument Description CashierName string &lt;optional&gt; имя кассира numDevice number &lt;optional&gt; устройство Returns: Type KkmCommandWithCashier CommandPaymentCash(Amount [, CashierName] [, numDevice]) Команда Выемка наличных Parameters: Name Type Argument Description Amount number Сумма CashierName string &lt;optional&gt; имя кассира numDevice number &lt;optional&gt; устройство Returns: Type KkmCommandWithAmount CommandXReport( [CashierName] [, numDevice]) Команда Печать Х-отчета Parameters: Name Type Argument Description CashierName string &lt;optional&gt; имя кассира numDevice number &lt;optional&gt; устройство Returns: Type KkmCommandWithCashier CommandZReport( [CashierName] [, numDevice]) Команда Закрытие смены Parameters: Name Type Argument Description CashierName string &lt;optional&gt; имя кассира numDevice number &lt;optional&gt; устройство Returns: Type KkmCommandWithCashier doDepositingCash(Amount [, CashierName] [, numDevice]) Внесение денег в кассу Parameters: Name Type Argument Description Amount number Сумма CashierName string &lt;optional&gt; имя кассира numDevice number &lt;optional&gt; устройство Returns: Type KkmCommandWithAmount doGetDataKKT( [numDevice]) Получение данных KKT Parameters: Name Type Argument Description numDevice number &lt;optional&gt; устройство Returns: Type KkmCommand doGetList() Список ККТ подключенных к серверу Returns: Type KkmCommand doGetRezult( [IdCommand] [, numDevice]) Запрос результата выполнения команды Parameters: Name Type Argument Description IdCommand string &lt;optional&gt; numDevice number &lt;optional&gt; устройство Returns: Type KkmCommand doOfdReport( [numDevice]) Печать состояния обмена с ОФД Parameters: Name Type Argument Description numDevice number &lt;optional&gt; устройство Returns: Type KkmCommand doOpenCashDrawer( [numDevice]) Открыть денежный ящик Parameters: Name Type Argument Description numDevice number &lt;optional&gt; устройство Returns: Type KkmCommand doOpenShift( [cashierName] [, numDevice]) Окрыть смену Parameters: Name Type Argument Description cashierName string &lt;optional&gt; имя кассира numDevice number &lt;optional&gt; устройство Returns: Type KkmCommandWithCashier doPaymentCash(Amount [, CashierName] [, numDevice]) Выемка наличных Parameters: Name Type Argument Description Amount number Сумма CashierName string &lt;optional&gt; имя кассира numDevice number &lt;optional&gt; устройство Returns: Type KkmCommandWithAmount doXReport( [CashierName] [, numDevice]) Печать Х-отчета Parameters: Name Type Argument Description CashierName string &lt;optional&gt; имя кассира numDevice number &lt;optional&gt; устройство Returns: Type KkmCommand doZReport( [CashierName] [, numDevice]) Закрытие смены Parameters: Name Type Argument Description CashierName string &lt;optional&gt; имя кассира numDevice number &lt;optional&gt; устройство Returns: Type KkmCommand execute(command) Передача команды серверу . Parameters: Name Type Description command KkmCommand | KkmCommandWithCashier | KkmCommandWithAmount | KkmCommandList | KkmCommandCheck Структура для передачи серверу Returns: Type KkmCommand | KkmCommandWithCashier | KkmCommandWithAmount | KkmCommandList | KkmCommandCheck hookAjaxFail(errorHook) Назначить обработчик ошибки запроса Parameters: Name Type Description errorHook funError callback See: встроенный обработчик Returns: Type KkmServer hookAjaxSuccess(successHook) Назначить обработчик успешного запроса к серверу по умолчанию Parameters: Name Type Description successHook KkmServer~KkmApiСallback функция обработчик See: встроенный обработчик Returns: Type KkmServer setCashierName(cashierName) Кассир по умолчанию Parameters: Name Type Description cashierName string ФИО Returns: Type KkmServer setInnKkm(innKkm) Инн кассы чтобы чек не ушел неправильно Parameters: Name Type Description innKkm string Returns: Type KkmServer setLicensing(licensing) Установка ключа суб-лицензии Parameters: Name Type Description licensing Returns: Type KkmServer setNumDevice(numDevice) Номер Устройства по умолчанию Parameters: Name Type Description numDevice number целое 0-9 Returns: Type KkmServer &lt;inner&gt; funError(xhr, status) Встроенный обработчик ошибки сети при запросе к серверу Parameters: Name Type Description xhr status See: назначить свой hookAjaxFail &lt;inner&gt; funSuccess(result) Встроенный обработчик успешного запроса к серверу Parameters: Name Type Description result KkmResponse | object See: назначить свой hookAjaxSuccess Type Definitions KkmApiСallback(ответ) Описание интерфейса для функции обратного вызова Parameters: Name Type Description ответ KkmResponse от АПИ See: установка хука × Search results Close "}}
    </script>

    <script type="text/javascript">
        $(document).ready(function() {
            Searcher.init();
        });

        $(window).on("message", function(msg) {
            var msgData = msg.originalEvent.data;

            if (msgData.msgid != "docstrap.quicksearch.start") {
                return;
            }

            var results = Searcher.search(msgData.searchTerms);

            window.parent.postMessage({"results": results, "msgid": "docstrap.quicksearch.done"}, "*");
        });
    </script>
</body>
</html>
